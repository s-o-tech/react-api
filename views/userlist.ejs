<!DOCTYPE html>
<html>
<%- include('./header'); %>
<body>

<h1>All Users</h1>

<table>
  <tbody>
  <% for(let user of users){ %>
    <tr>
      <td>
        <a class="nav-link" href="/users/<%= user.id %>"><%= user.name %></a>
      </td>

      <% if(isAdmin){ %>
      <td>
        <a href="" class="delete-confirm" data-toggle="modal" data-target="#deleteModal" data-whatever="<%= user.id %>">delete</a>
      </td>
      <% } %>
    </tr>

  <% } %>
  </tbody>
</table>

<!-- Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel"
     aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="deleteModalLabel">削除確認</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        本当に<a id="deleteUser">user</a>を削除しますか？

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <form action="/userlist" method="post">
          <input type="hidden" name="target" id="deleteTarget"/>
          <button type="submit" class="btn btn-primary" id="deleteButton">Delete</button>
        </form>
      </div>
    </div>
  </div>
</div>

<nav aria-label="Page navigation example">
  <ul class="pagination">
    <% if (pagination.currentPage != 1){ %>
      <li class="page-item">
        <a class="page-link" href="?page=<%= pagination.currentPage - 1 %>" aria-label="Previous">
          Previous
        </a>
      </li>
    <% } else { %>
      <li class="page-item disabled">
        <a class="page-link" aria-label="Previous">
          Previous
        </a>
      </li>
    <% } %>

    <% for (let i = pagination.currentPage - 2;i <= pagination.currentPage + 2 && i <= pagination.lastPage; i++){ %>
      <% if (i < 1) continue; %>
      <% if ( i == pagination.currentPage){ %>
        <li class="page-item active"><a class="page-link" href="?page=<%= i %>"><%= i %></a></li>
      <% } else { %>
        <li class="page-item"><a class="page-link" href="?page=<%= i %>"><%= i %></a></li>
      <% } %>
    <% } %>

    <% if (pagination.currentPage != pagination.lastPage){ %>
      <li class="page-item">
        <a class="page-link" href="?page=<%= pagination.currentPage + 1 %>" aria-label="Next">
          Next
        </a>
      </li>
    <% } else { %>
      <li class="page-item disabled">
        <a class="page-link" aria-label="Next">
          Next
        </a>
      </li>
    <% } %>
  </ul>
</nav>

</body>

<footer>
  <%- include('./footer'); %>
  <script src="/js/deleteuser.js"></script>
</footer>
</html>
